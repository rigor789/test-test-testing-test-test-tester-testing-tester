import{o as c,c as a,a as i,d as p,u as D,b as E,e as u,f as v,g as b,h as L,i as N,r as f,j as $,k as g,F as h,l as x,m,t as w,n as A}from"./vendor.b8745aeb.js";const C=function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))r(e);new MutationObserver(e=>{for(const n of e)if(n.type==="childList")for(const d of n.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&r(d)}).observe(document,{childList:!0,subtree:!0});function o(e){const n={};return e.integrity&&(n.integrity=e.integrity),e.referrerpolicy&&(n.referrerPolicy=e.referrerpolicy),e.crossorigin==="use-credentials"?n.credentials="include":e.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function r(e){if(e.ep)return;e.ep=!0;const n=o(e);fetch(e.href,n)}};C();const O={width:"1.2em",height:"1.2em",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 24 24"},S=i("g",{fill:"none"},[i("path",{d:"M20.354 15.354A9 9 0 0 1 8.646 3.646A9.003 9.003 0 0 0 12 21a9.003 9.003 0 0 0 8.354-5.646z",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1),V=[S];function j(t,s){return c(),a("svg",O,V)}var B={name:"heroicons-outline-moon",render:j};const M={width:"1.2em",height:"1.2em",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 24 24"},F=i("g",{fill:"none"},[i("path",{d:"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 1 1-8 0a4 4 0 0 1 8 0z",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1),J=[F];function P(t,s){return c(),a("svg",M,J)}var R={name:"heroicons-outline-sun",render:P};const T=p({setup(t){const s=D(),o=E(s);return(r,e)=>{const n=R,d=B;return c(),a("button",{onClick:e[0]||(e[0]=_=>u(o)()),class:"text-xl flex"},[u(s)?(c(),v(n,{key:0})):(c(),v(d,{key:1}))])}}}),q={key:0,class:"p-4 bg-white rounded-md shadow-xl w-72 h-72"},z=["src"],G=p({props:{sessionID:String},setup(t){const s=t,o=b(L(()=>`play://session?id=${s.sessionID}`),{margin:0,scale:10});return(r,e)=>t.sessionID?(c(),a("div",q,[i("img",{src:u(o),alt:"QR Code",class:"w-full h-full rounded-md"},null,8,z)])):N("",!0)}});var l;(function(t){t.HEARTBEAT="heartbeat",t.JOIN="join",t.DEVICE_JOIN="device_join",t.DEVICE_LEAVE="device_leave",t.INITIAL_FILES="initial_files",t.FILES="files",t.DEVICE_LOG="device_log"})(l||(l={}));function H(t){return{type:l.JOIN,data:{name:t}}}const I="worker.rigor789.workers.dev",Q=t=>new Promise(s=>setTimeout(s,t));function k(){return fetch("/api/session").then(async t=>{if(!t.ok)return console.log("Could not get current sessionID, retrying in 3 seconds..."),await Q(3e3),k();const s=await t.text();return console.log("Got the current sessionID:",s),s})}async function Y(t){const s=await k(),o=new WebSocket(`ws://${I}/api/session/${s}/websocket`),r=e=>{typeof e!="string"&&(e=JSON.stringify(e)),o.send(e)};return o.addEventListener("open",e=>{r(H("frontend"))}),o.addEventListener("message",e=>{try{t(JSON.parse(e.data),r)}catch(n){console.log(n)}}),console.log({sessionID:s}),{sessionID:s,ws:o}}function K(){const t=f(),s=f([]),o=f(new Map),r=f();return Y((e,n)=>{if(s.value.unshift(e),!!e.data)switch(e.type){case l.INITIAL_FILES:y(t.value,e.data.files);break;case l.FILES:y(t.value,e.data.emittedAssets);break;case l.DEVICE_JOIN:o.value.set(e.data.id,e.data);break;case l.DEVICE_LEAVE:o.value.delete(e.data.id);break}}).then(e=>{t.value=e.sessionID,r.value=e.ws}),{sessionID:t,logs:s,devices:o,ws:r}}async function y(t,s){for(const o of s){const r=await fetch(`http://${I}/api/session/${t}/download`,{method:"POST",body:o});console.log(r)}}const W={class:"flex items-center justify-between px-6 py-4"},U=i("div",{class:"text-xl font-semibold text-gray-900 dark:text-white"},[m(" Playground "),i("span",{class:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-purple-100 text-purple-900"},"Beta")],-1),X={class:"flex items-center justify-center p-4"},Z=i("div",{class:"flex items-start px-4 space-x-4"},null,-1),ee={class:"p-4 dark:text-white"},te={class:"overflow-y-scroll max-h-96"},se=m(" Logs: "),oe={class:"p-2 mt-2 text-xs bg-gray-300 rounded"},ne={class:"overflow-y-scroll max-h-96"},re=m(" Devices: "),ie={class:"p-2 mt-2 text-xs bg-gray-300 rounded"},ce=p({setup(t){$();const{sessionID:s,devices:o,logs:r,ws:e}=K();return(n,d)=>(c(),a(h,null,[i("div",W,[U,i("div",null,[g(T,{class:"text-gray-800 dark:text-white"})])]),i("div",X,[g(G,{sessionID:u(s)},null,8,["sessionID"])]),Z,i("div",ee,[i("div",te,[se,(c(!0),a(h,null,x(u(r),_=>(c(),a("pre",oe,w(_),1))),256))]),i("div",ne,[re,(c(!0),a(h,null,x(u(o),_=>(c(),a("pre",ie,w(_),1))),256))])])],64))}});A(ce).mount("#app");
